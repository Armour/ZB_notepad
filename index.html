<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<title>ZB_notepad</title>
	<script src="Screen.js"></script>
	<script src="CharInput.js"></script>
	<script src="modernizr.min.js"></script>
</head>

<body>
	<div style="position: absolute; top: 50%; left: 50%; margin-top: -300px; margin-left: -500px">
		<canvas id="canvasOne" width="1000" height="600">
			Your browser does not support HTML5 Canvas.
		</canvas>
	</div>

	<div style="position: absolute; top: 0; left: 0;">
		<canvas id="input" width="256" height="256" hidden>
			Your browser does not support HTML5 Canvas.
		</canvas>
	</div>

	<script>
		window.addEventListener("keydown", updateCanvas);
		var _option = {
			name: "input",
			width: "192",
			height: "36"
		}
		var i = 0;
		var _input = new Input(_option);
		var _canvas = document.getElementById("canvasOne");
		var _canvasContext = _canvas.getContext("2d");
		localStorage.setItem("buffer", JSON.stringify(_canvasContext.getImageData(0, 0, _inputCanvas.width, _inputCanvas.height).data));

		function updateCanvas() {
			_input.init();
			var _inputCanvas = _input.getbox();
			if (typeof localStorage["buffer"] !== "undefined" && localStorage["buffer"] !== "undefined") {
				var _tmpObject = JSON.parse(localStorage["buffer"]);
				var _tmpImageData = _canvasContext.getImageData(0, 0, _inputCanvas.width, _inputCanvas.height);
				for (var key in _tmpObject)
					_tmpImageData.data[key] = _tmpObject[key];
				_canvasContext.putImageData(_tmpImageData, i, i, 0, 0, _inputCanvas.width, _inputCanvas.height);
				localStorage.removeItem("buffer");
				i+=3;
				if (i > 400) i = 0;
			}
			localStorage.setItem("buffer", JSON.stringify(_canvasContext.getImageData(i, i, _inputCanvas.width, _inputCanvas.height).data));
			_canvasContext.putImageData(_inputCanvas, i, i, 0, 0, _inputCanvas.width, _inputCanvas.height);
			setTimeout(updateCanvas, 100);
		}

		updateCanvas();
	</script>
</body>

</html>
